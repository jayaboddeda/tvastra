<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="..\assets\css\reset.css" type="text/css">
        <link rel="stylesheet" href="..\assets\css\theme.css" type="text/css">
        <link rel="stylesheet" href="..\assets\css\index.css" type="text/css">
        <link rel="stylesheet" href="..\assets\css\login.css" type="text/css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://kit.fontawesome.com/b5fc96aecf.js" crossorigin="anonymous"></script>
        <title>Login</title>
    </head>
    <body>
      <%- include("partials/header.ejs") %>
             <div class="loginform-container">
             <div class="loginform">
                 <div class="login-header">
                    <h4>Login</h4>
                 </div>
                 <div class="loginfrm-inp">
                     <form action="/" method="post" id="formaction">
                     <div class="login-qstn">
                        <input type="text" required placeholder="Enter Email Address" name="email">
                        <i class="fas fa-question-circle qstn"></i>
                     </div>
                    <div class="login-qstn">
                    <input id="passwordField"  type="password" placeholder="Enter Password" name="password">
                    <i class="fas fa-eye fa-eye-slash qstn"  id="showPassword"></i>
                </div>
                 <ul class="otp-forgot">
                     <a href="/phone-login"><li>Login with OTP</li></a>
                    <li id="forgotPassword">Forgot Password</li>
                 </ul>
                 <div class="arrow">
                    <button type="submit" class="loginform-btn dark-button"><h6>LOGIN</h6></button>
                    <i class="fas fa-arrow-right rarrow"></i>
                 </div>
                </form>
                 <p>Not Registered? <a href="/signup"><span>Sign Up</span></a></p>
             </div>
            </div>
            <div class="login-copyright">
                <p>All Rights Reserved. tvastra 2018</p>
            </div>

            <script>
                const showPasswordBtn = document.querySelector('#showPassword');
                const passwordField = document.querySelector('#passwordField');
                const forgotPasswordBtn = document.querySelector('#forgotPassword');
 
                showPasswordBtn.addEventListener('click', (el) => {
                    showPasswordBtn.classList.toggle("fa-eye-slash");
                    if(passwordField.type == 'text') {
                        passwordField.type = 'password';	
                    } else {
                        passwordField.type = 'text';
                    }
                })

                const forgotPassword = async () => {
	const emailAddress = document.querySelector('input[name="email"]').value;
  
	const response = await fetch('/forgot-password', {
		method: 'post',
		headers:{ 
			"Content-Type": "application/json" 
		},
		body: JSON.stringify({ email: emailAddress }),
	});
	window.location.replace(response.url);
}

forgotPasswordBtn.addEventListener('click', forgotPassword);
            </script>

    </body>
</html>